name: mern-js-dev

services:
  web:
    extends:
      service: web
      file: ./frontend/docker/docker-compose-dev.yaml
    depends_on:
      - api
    image: mern-js-dev-web
    container_name: mern-js-dev-web
    develop:
      watch:
        # dependencies
        - path: ./frontend/package.json
          action: rebuild
        - path: ./frontend/package-lock.json
          action: rebuild
        # app
        - path: ./frontend
          target: /app
          action: sync

  api:
    extends:
      service: api
      file: ./backend/docker/docker-compose-dev.yaml
    depends_on:
      - db
    image: mern-js-dev-api
    container_name: mern-js-dev-api
    develop:
      watch:
        # dependencies
        - path: ./backend/package.json
          action: rebuild
        - path: ./backend/package-lock.json
          action: rebuild
        # app
        - path: ./backend
          target: /app
          action: sync

  db:
    extends:
      service: db
      file: ./backend/docker/docker-compose-dev.yaml
    container_name: mern-js-dev-db

# volumes
volumes:
  anime: